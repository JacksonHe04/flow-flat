


          
# Flow Flat ğŸš€

> ä¸€ä¸ªé›†æˆäº†è‡ªç ” React Flow èŠ‚ç‚¹ç»„ä»¶åº“çš„ç»¼åˆå¼€å‘å¹³å°

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-20232A?logo=react&logoColor=61DAFB)](https://reactjs.org/)
[![Vite](https://img.shields.io/badge/Vite-646CFF?logo=vite&logoColor=white)](https://vitejs.dev/)

## ğŸ“– é¡¹ç›®æ¦‚è¿°

Flow Flat æ˜¯ä¸€ä¸ªåˆ›æ–°çš„å¼€å‘å¹³å°ï¼Œé›†æˆäº†**èŠ‚ç‚¹æµç¨‹å›¾**ã€**å¯Œæ–‡æœ¬ç¼–è¾‘å™¨**ã€**ä»£ç ç¼–è¾‘å™¨**ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ã€‚é¡¹ç›®çš„æ ¸å¿ƒäº®ç‚¹æ˜¯è‡ªç ”çš„ `custom-react-flow-node` ç»„ä»¶åº“ï¼Œä¸º React Flow æä¾›äº†æ›´åŠ çµæ´»å’Œå¼ºå¤§çš„èŠ‚ç‚¹ç³»ç»Ÿã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- ğŸ¨ **è‡ªç ”èŠ‚ç‚¹ç»„ä»¶åº“**: å®Œå…¨è‡ªä¸»å¼€å‘çš„ React Flow èŠ‚ç‚¹ç³»ç»Ÿ
- ğŸ”§ **å®Œæ•´ TypeScript æ”¯æŒ**: ç±»å‹å®‰å…¨çš„å¼€å‘ä½“éªŒ
- ğŸ”Œ **é«˜åº¦å¯æ‰©å±•**: æ”¯æŒè‡ªå®šä¹‰èŠ‚ç‚¹ç±»å‹æ³¨å†Œ
- ğŸ“¦ **æ¨¡å—åŒ–æ¶æ„**: ç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- ğŸª **ä¸°å¯Œçš„å†…ç½®ç»„ä»¶**: TextNodeã€CodeNodeã€ImageNode ç­‰å¤šç§èŠ‚ç‚¹ç±»å‹
- ğŸŒ™ **ä¸»é¢˜ç³»ç»Ÿ**: ç»Ÿä¸€çš„äº®è‰²/æš—è‰²ä¸»é¢˜æ”¯æŒ

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

æœ¬ä»“åº“é‡‡ç”¨ **Monorepo** æ¶æ„ï¼ŒåŒ…å«ä»¥ä¸‹ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š

```
flow-flat/
â”œâ”€â”€ ğŸ“¦ package-custom-react-flow-node/    # è‡ªç ” React Flow èŠ‚ç‚¹ç»„ä»¶åº“
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/                   # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Node.tsx                  # é€šç”¨èŠ‚ç‚¹ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ NodeContainer.tsx         # èŠ‚ç‚¹å®¹å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ NodeHeader.tsx            # èŠ‚ç‚¹å¤´éƒ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ NodeStoreAdapter.tsx      # çŠ¶æ€é€‚é…å™¨
â”‚   â”‚   â”‚   â””â”€â”€ TextNode.tsx              # æ–‡æœ¬èŠ‚ç‚¹
â”‚   â”‚   â””â”€â”€ types/                        # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ dist/                             # æ„å»ºè¾“å‡º
â””â”€â”€ ğŸŒ flow-flat-app/                     # Web åº”ç”¨å¹³å°
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ components/
    â”‚   â”‚   â”œâ”€â”€ Node/                      # èŠ‚ç‚¹ç³»ç»Ÿ
    â”‚   â”‚   â”œâ”€â”€ Markdown/                  # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
    â”‚   â”‚   â””â”€â”€ CodeEditor/                # ä»£ç ç¼–è¾‘å™¨
    â”‚   â”œâ”€â”€ pages/                         # é¡µé¢ç»„ä»¶
    â”‚   â””â”€â”€ stores/                        # çŠ¶æ€ç®¡ç†
    â””â”€â”€ ...
```

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶åº“ï¼šcustom-react-flow-node

### âœ¨ ç‰¹æ€§

- ğŸ¨ **å¯å®šåˆ¶èŠ‚ç‚¹**: æ”¯æŒè‡ªå®šä¹‰èŠ‚ç‚¹ç±»å‹å’Œæ ·å¼
- ğŸ”§ **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript æ”¯æŒ
- ğŸ¯ **æ˜“äºä½¿ç”¨**: ç®€å•çš„ API è®¾è®¡
- ğŸ”Œ **å¯æ‰©å±•**: æ”¯æŒæ³¨å†Œè‡ªå®šä¹‰èŠ‚ç‚¹ç±»å‹
- ğŸ“¦ **è½»é‡çº§**: æœ€å°åŒ–ä¾èµ–
- ğŸª **å†…ç½®ç»„ä»¶**: æä¾›å¸¸ç”¨çš„èŠ‚ç‚¹ç»„ä»¶

### ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# å®‰è£…ä¾èµ–
npm install custom-react-flow-node
# æˆ–
pnpm add custom-react-flow-node
```

### ğŸ“ åŸºç¡€ä½¿ç”¨

```tsx
import React from 'react';
import { ReactFlow, Node as FlowNode } from '@xyflow/react';
import { Node, BaseNodeData } from 'custom-react-flow-node';

// å®šä¹‰èŠ‚ç‚¹æ•°æ®ç±»å‹
interface MyNodeData extends BaseNodeData {
  title: string;
  content: string;
}

// åˆ›å»ºèŠ‚ç‚¹
const nodes: FlowNode<MyNodeData>[] = [
  {
    id: '1',
    type: 'custom',
    position: { x: 100, y: 100 },
    data: {
      nodeType: 'text',
      title: 'æˆ‘çš„èŠ‚ç‚¹',
      content: 'è¿™æ˜¯èŠ‚ç‚¹å†…å®¹'
    }
  }
];

// å®šä¹‰èŠ‚ç‚¹ç±»å‹
const nodeTypes = {
  custom: Node
};

function App() {
  return (
    <div style={{ height: '100vh' }}>
      <ReactFlow
        nodes={nodes}
        nodeTypes={nodeTypes}
      />
    </div>
  );
}
```

### ğŸ”§ è‡ªå®šä¹‰èŠ‚ç‚¹

```tsx
import React from 'react';
import { CustomNodeProps, BaseNodeData, NodeContainer, NodeHeader } from 'custom-react-flow-node';

interface MyNodeData extends BaseNodeData {
  value: number;
}

const MyCustomNode: React.FC<CustomNodeProps<MyNodeData>> = ({ data, selected }) => {
  const handleValueChange = (newValue: number) => {
    if (data?.onDataChange) {
      data.onDataChange({ value: newValue });
    }
  };

  return (
    <NodeContainer selected={selected} onDelete={data?.onDelete}>
      <NodeHeader
        nodeType="custom"
        title={data?.title || 'è‡ªå®šä¹‰èŠ‚ç‚¹'}
        onTitleChange={(title) => data?.onDataChange?.({ title })}
      />
      <div>
        <input
          type="number"
          value={data?.value || 0}
          onChange={(e) => handleValueChange(Number(e.target.value))}
        />
      </div>
    </NodeContainer>
  );
};

// æ³¨å†ŒèŠ‚ç‚¹ç±»å‹
import { registerNodeType } from 'custom-react-flow-node';
registerNodeType('myCustom', MyCustomNode);
```

## ğŸŒ Web åº”ç”¨å¹³å°ï¼šflow-flat-app

### ğŸ¯ åŠŸèƒ½æ¨¡å—

#### 1. ğŸ“Š èŠ‚ç‚¹æµç¨‹å›¾ç³»ç»Ÿ

åŸºäºè‡ªç ” `custom-react-flow-node` åŒ…å®ç°çš„å¯è§†åŒ–èŠ‚ç‚¹ç¼–è¾‘å™¨ï¼š

- **æ ¸å¿ƒç»„ä»¶å±•ç¤º**: NodeLayoutã€å†…ç½®èŠ‚ç‚¹ç±»å‹ã€å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
- **æœ¬åœ°åŒ…é›†æˆæ¼”ç¤º**: å®Œæ•´çš„é›†æˆæ–¹æ¡ˆå’Œç¤ºä¾‹
- **é›†æˆæ–¹æ¡ˆç‰¹ç‚¹**: å‘åå…¼å®¹ã€æ¸è¿›å¼è¿ç§»ã€æ‰©å±•èƒ½åŠ›ã€çŠ¶æ€åŒæ­¥

#### 2. ğŸ“ å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ¨¡å—

åŸºäº TipTap çš„å®Œæ•´å¯Œæ–‡æœ¬ç¼–è¾‘è§£å†³æ–¹æ¡ˆï¼š

- **æ ¸å¿ƒç»„ä»¶**: RichTextã€MarkdownNodeEditor
- **å·¥å…·æ ç³»ç»Ÿ**: å®Œæ•´çš„æ ¼å¼åŒ–å·¥å…·æ 
- **æ‰©å±•é…ç½®**: åŸºç¡€æ‰©å±•ã€èŠ‚ç‚¹æ‰©å±•ã€é¡µé¢æ‰©å±•
- **åŠŸèƒ½ç‰¹æ€§**: Markdown æ”¯æŒã€æ‰€è§å³æ‰€å¾—ã€è‡ªåŠ¨ä¿å­˜ã€ä¸»é¢˜æ”¯æŒ

#### 3. ğŸ’» ä»£ç ç¼–è¾‘å™¨æ¨¡å—

åŸºäº Monaco Editor çš„ä¸“ä¸šä»£ç ç¼–è¾‘åŠŸèƒ½ï¼š

- **æ ¸å¿ƒç»„ä»¶**: MonacoEditorã€LanguageSelector
- **åŠŸèƒ½ç‰¹æ€§**: è¯­æ³•é«˜äº®ã€æ™ºèƒ½æç¤ºã€é”™è¯¯æ£€æµ‹ã€ä¸»é¢˜æ”¯æŒ
- **æ”¯æŒè¯­è¨€**: 26+ ç§ç¼–ç¨‹è¯­è¨€

### ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: React + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **çŠ¶æ€ç®¡ç†**: Zustand
- **èŠ‚ç‚¹æµç¨‹å›¾**: React Flow + custom-react-flow-node
- **å¯Œæ–‡æœ¬ç¼–è¾‘**: TipTap
- **ä»£ç ç¼–è¾‘å™¨**: Monaco Editor
- **æ ·å¼**: Tailwind CSS

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- Node.js >= 16.0.0
- pnpm >= 7.0.0

### ğŸ”§ å®‰è£…å’Œè¿è¡Œ

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/JacksonHe04/flow-flat.git
cd flow-flat

# å®‰è£…ä¾èµ–
pnpm install

# æ„å»ºç»„ä»¶åº“
cd package-custom-react-flow-node
pnpm run build

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd ../flow-flat-app
pnpm run dev
```

### ğŸŒ è®¿é—®åº”ç”¨

å¼€å‘æœåŠ¡å™¨å¯åŠ¨åï¼Œè®¿é—® [http://localhost:5173](http://localhost:5173) å³å¯ä½“éªŒå®Œæ•´åŠŸèƒ½ã€‚

## ğŸ“š ä½¿ç”¨åœºæ™¯

### ğŸ”¬ èŠ‚ç‚¹æµç¨‹å›¾å¼€å‘
- **ç‹¬ç«‹å¼€å‘æµ‹è¯•**: ä½¿ç”¨ `DemoBoard` ç‹¬ç«‹æµ‹è¯•æ–°èŠ‚ç‚¹ç±»å‹
- **é›†æˆéªŒè¯**: ä½¿ç”¨ `TestBoard` éªŒè¯ä¸åŸé¡¹ç›®çš„å…¼å®¹æ€§
- **ç”Ÿäº§æ›¿æ¢**: ä½¿ç”¨ `NodeLayoutReplacement` ç›´æ¥æ›¿æ¢åŸé¡¹ç›®çš„ NodeLayout
- **æ‰©å±•å¼€å‘**: å‚è€ƒè‡ªå®šä¹‰èŠ‚ç‚¹ç¤ºä¾‹å¼€å‘æ–°çš„èŠ‚ç‚¹ç±»å‹

### ğŸ“ å¯Œæ–‡æœ¬ç¼–è¾‘
- **æµç¨‹å›¾èŠ‚ç‚¹å†…å®¹ç¼–è¾‘**: è½»é‡çº§çš„èŠ‚ç‚¹å†…åµŒç¼–è¾‘å™¨
- **æ–‡æ¡£é¡µé¢ç¼–è¾‘**: å®Œæ•´çš„é¡µé¢çº§ç¼–è¾‘å™¨
- **è‡ªå®šä¹‰ç¼–è¾‘å™¨**: æ ¹æ®éœ€è¦è¿›è¡Œé…ç½®çš„ç¼–è¾‘å™¨

### ğŸ’» ä»£ç ç¼–è¾‘
- **ä»£ç èŠ‚ç‚¹ç¼–è¾‘**: åœ¨æµç¨‹å›¾èŠ‚ç‚¹ä¸­ç¼–è¾‘ä»£ç 
- **ç‹¬ç«‹ä»£ç ç¼–è¾‘**: ä¸“ä¸šçš„ä»£ç ç¼–è¾‘é¡µé¢
- **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒä¸»æµç¼–ç¨‹è¯­è¨€çš„è¯­æ³•é«˜äº®

## ğŸ¨ æŠ€æœ¯äº®ç‚¹

1. **ğŸ”§ è‡ªç ”ç»„ä»¶åŒ…**: å®Œå…¨è‡ªä¸»å¼€å‘çš„ React Flow èŠ‚ç‚¹ç»„ä»¶åº“
2. **ğŸ”„ é€‚é…å™¨æ¨¡å¼**: é€šè¿‡ `NodeStoreAdapter` å®ç°ä¸ç°æœ‰ç³»ç»Ÿçš„æ— ç¼é›†æˆ
3. **ğŸ“ˆ æ¸è¿›å¼è¿ç§»**: æ”¯æŒä»åŸæœ‰ç³»ç»Ÿå¹³æ»‘è¿ç§»åˆ°æ–°çš„èŠ‚ç‚¹ç³»ç»Ÿ
4. **ğŸ¯ å¤šåœºæ™¯æ”¯æŒ**: åŒæ—¶æ”¯æŒèŠ‚ç‚¹å†…åµŒå’Œé¡µé¢çº§çš„ç¼–è¾‘åœºæ™¯
5. **ğŸ›¡ï¸ å®Œæ•´çš„ç±»å‹æ”¯æŒ**: å…¨é¢çš„ TypeScript ç±»å‹å®šä¹‰
6. **âš™ï¸ é«˜åº¦å¯é…ç½®**: ä¸°å¯Œçš„é…ç½®é€‰é¡¹æ»¡è¶³ä¸åŒéœ€æ±‚

## ğŸ“– æ–‡æ¡£

- [ç»„ä»¶åº“æ–‡æ¡£](./package-custom-react-flow-node/README.md) - custom-react-flow-node è¯¦ç»†æ–‡æ¡£
- [Webåº”ç”¨æ–‡æ¡£](./flow-flat-app/README.md) - flow-flat-app è¯¦ç»†æ–‡æ¡£

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼è¯·æŸ¥çœ‹æˆ‘ä»¬çš„è´¡çŒ®æŒ‡å—ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºä½ çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤ä½ çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ä¸€ä¸ª Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ‘¨â€ğŸ’» ä½œè€…

**Jackson He**
- GitHub: [@JacksonHe04](https://github.com/JacksonHe04)
- é¡¹ç›®é“¾æ¥: [https://github.com/JacksonHe04/flow-flat](https://github.com/JacksonHe04/flow-flat)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š

- [React Flow](https://reactflow.dev/) - å¼ºå¤§çš„æµç¨‹å›¾åº“
- [TipTap](https://tiptap.dev/) - ç°ä»£å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
- [Monaco Editor](https://microsoft.github.io/monaco-editor/) - VS Code ç¼–è¾‘å™¨æ ¸å¿ƒ
- [Tailwind CSS](https://tailwindcss.com/) - å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- [Zustand](https://github.com/pmndrs/zustand) - è½»é‡çº§çŠ¶æ€ç®¡ç†

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼
        